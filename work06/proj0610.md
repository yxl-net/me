# 报装业务管理系统附件上传
+ [我的简历](../README.md)
## 业务描述
+ 用于报装业务管理系统的附件上传，显示和统计，使用分片方式支持大文件的上传。
+ 报装业务管理系统PC端使用的FlowPort原生的附件控件不能满足要求(主要是不能传大附件和附件搜索不方便)，特开发了该模块，并于报装管理系统进行整合，并且附件上传不影响界面操作
## 数据规模
+ 最大表数量级
    + 10万级
+ 最大访问峰值
    + 十次级/秒
+ 月访问次数
    + 万级
+ 用户数
    + 十级
## 技术栈
## 功能模块
+ 发起页面上传附件
+ 审批页面上传及查看附件
    + 可搜索并下载附件
+ 调用高拍仪
+ 附件查询及下载
+ 附件预览
    + 缩放、旋转、截取、写文字并保存
+ 附件归档
    + 将附件按所属的目录压缩为zip
    + 可按条件下载zip
## 技术实现
+ 作为FlowPort的iframe页面
		+ 获取报装页面的流程编号、步骤编号、用户号等数据
			+ 审批页面
				+ 通过iframe的src地址的查询参数传入
				+ 监听路由地址的变化来进行后续操作
			+ 发起页面
				+ 因发起页面还没有流程编号，步骤编号等数据，所以使用用户号进行关联
					+ 附件页在开始使用时，清空该用户的数据库记录
					+ 上传时附件记录发起页名和用户号
					+ 发起页提交后，通过触发器依用户号变更附件表的流程编号和步骤编号
	+ 大文件的传输
		+ 分片传递字节数组
			+ 前端调用Ajax依次分片传递字节数组
			+ 后端直接追加字节数组按流的方式保存到文件 
	+ 附件删除为修改数据库状态，不删除附件及对应数据库表
	+ 高拍仪为单独的内嵌页面
		+ 内嵌页面为高拍仪的示例页面
			+ 加上部分方法
		+ 附件页面调用高拍仪页面window内的方法
			+ 进行高拍仪拍照
			+ 将拍照保存的图片的字节数组使用附件上传的方法上传到服务器
## 问题和解决
## 我的角色
## 我的收获
+ 快速解决问题的能力
+ 能开发Web端大附件上传
 